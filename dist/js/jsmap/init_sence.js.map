{"version":3,"sources":["init_sence.js"],"names":["imageNumber","imageWidth","sliceWrapTranslateZ","sliceWrapRotateY","initStageTranslateZ","allowRotateX","signUpLink","stopOrienter","$sliceWrap","$","sliceWrap","$stage","stage","str","i","console","log","html","$slices","find","calculateR","width","deg","Math","tan","PI","R","each","index","item","css","transform","append","lastTime","vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","callback","element","currTime","Date","getTime","timeToCall","max","id","setTimeout","clearTimeout"],"mappings":"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","file":"init_sence.js","sourcesContent":["const imageNumber = 28;\n\nconst imageWidth = 130;\n\nconst sliceWrapTranslateZ = 0;\n\nconst sliceWrapRotateY = 175;\n\nconst initStageTranslateZ = 700;\n\nconst allowRotateX = 50;\n\nconst signUpLink = 'http://hongyan.cqupt.edu.cn/2016joinus';\n\nlet stopOrienter = false;\n\n\n\nlet $sliceWrap = $('.slice-wrap'),\n    sliceWrap = $sliceWrap[0];\n\nlet $stage = $('.stage'),\n    stage = $stage[0];\n\n\n// 初始化\n(function() {\n    let str = '';\n\n    for(let i = 1; i <= imageNumber; i ++) {\n        str += `<div class=\"slice\"></div>`;\n    }\n    console.log(str);\n\n    $sliceWrap.html(str);\n    let $slices = $sliceWrap.find('.slice');\n\n    function calculateR(imageNumber, width) {\n        let deg = 360/imageNumber/2;\n        return (width/2) / Math.tan( 2 * Math.PI * (deg / 360)) - 10;\n    }\n    let R = calculateR(imageNumber, imageWidth);\n\n    $slices.each((index, item) => {\n\n        $(item).css({\n            transform: `rotateY(${-360/imageNumber*index}deg) translateZ(-${R}px) translateY(-50px)`\n        });\n    });\n\n    $sliceWrap.append(`<div class='sky' \n                            style='width: ${1.7*R}px; \n                            height: ${1.7*R}px;\n                            background-image: url(\"dist/img/sky.png\");\n                            background-size: 100% 100%;\n                            transform: rotateX(-90deg) translateZ(-600px) translateX(-50%)'></div>`)\n\n\n    $sliceWrap.append(`<div class='sky' \n                            style='width: ${2.5*R}px; \n                            height: ${2.5*R}px;\n                            background-image: url(\"dist/img/sky.png\");\n                            background-size: 100% 100%;\n                            transform: rotateX(90deg) translateZ(-600px) translateX(-50%)'></div>`);\n\n\n\n    $sliceWrap.append(`<a class=\"link\" href=\"${signUpLink}\" style=\"\n                            z-index: 10000;\n                            display: inline-block;\n                            width: 200px; \n                            height: 75px;\n                            transform: rotateY(-325.429deg) translateZ(-570.891px) translateY(-1787px);\"><a>`);\n\n\n\n    $sliceWrap.css({\n        transform: `translateZ(${sliceWrapTranslateZ}px) rotateY(${sliceWrapRotateY}deg)`\n    });\n\n    $stage.css({\n        transform: `translateZ(${initStageTranslateZ}px)`\n    })\n\n}());\n\n\n\n// requestAnimationFrame\n(function () {\n    'use strict';\n    var lastTime = 0;\n    var vendors = ['webkit', 'moz'];\n    for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n        window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\n        window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame'] || // Webkit中此取消方法的名字变了\n        window[vendors[x] + 'CancelRequestAnimationFrame'];\n    }\n\n    if (!window.requestAnimationFrame) {\n        window.requestAnimationFrame = function (callback, element) {\n            var currTime = new Date().getTime();\n            var timeToCall = Math.max(0, 16.7 - (currTime - lastTime));\n            var id = window.setTimeout(function () {\n                callback(currTime + timeToCall);\n            }, timeToCall);\n            lastTime = currTime + timeToCall;\n            return id;\n        };\n    }\n    if (!window.cancelAnimationFrame) {\n        window.cancelAnimationFrame = function (id) {\n            clearTimeout(id);\n        };\n    }\n})();\n"],"sourceRoot":"/source/"}